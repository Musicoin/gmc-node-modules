os: linux
services: docker
language: node_js
node_js: 8.9.0
install:
  - yarn --link-duplicates
script:
  - node ./clone
  - chmod +x ./src/build/env.sh
  - cd src && build/env.sh go run build/ci.go xgo -- --go=latest --targets=darwin -v ./cmd/gmc"
before_deploy:
  - chmod a+x bin/gmc-linux-amd64
deploy:
  provider: npm
  email: parker.casey@gmail.com
  api_key: ${NPM_TOKEN}
  skip_cleanup: true
  files: 
  - "package.json"
  - "bin/gmc-linux-amd64",
  on:
    repo: etaletai13/gmc-bin
    branch: npm-linux
